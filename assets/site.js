var fxcmSimpleAjax=function(){var e={},r={},o=function(t,n,e){r[t]=r[t]?r[t]+1:1,$.ajax({url:t,type:e.method||"GET",dataType:e.responseType||"json",data:e.params,success:function(e){delete r[t],n(e)},error:function(){r[t]<=3?o(t,n,e):n(!1)}})},i=function(e,t,n,r){return"string"==typeof e&&"function"==typeof t&&((n="object"==typeof n?n:{}).params="object"==typeof n.params?n.params:{},n.forceUnique&&(n.params.t=fxcm&&fxcm.internal&&"function"==typeof fxcm.internal.generateUniqueString?fxcm.internal.generateUniqueString(!0):Date.now()),n.method=-1<["GET","POST"].indexOf(r.toUpperCase())?r.toUpperCase():"GET",o(e,t,n))};return e.get=function(e,t,n){return i(e,t,n,"GET")},e.post=function(e,t,n){return i(e,t,n,"POST")},e}(),fxcmCountryBuckets=function(){var e={},t=fxcmcom.api_endpoint,n=[];return e.getAllBuckets=function(){return n.slice()},e.getBucket=function(e){e=e||"n/a";for(var t=0;t<n.length;t++)if(-1<n[t].countries.indexOf(e))return n[t];return!1},fxcmSimpleAjax.get(t+"/country-logic/country-buckets/",function(e){if("object"!=typeof e||!e.length)return!1;n=e,amplify.publish("fxcm.countryBuckets.onLoad")}),e}(),fxcmRbs=function(){var a={},e=fxcmcom.api_endpoint,c="/uk/"===fxcmcom.base_path?["ireland","united_kingdom"]:[],t=[],n=[],r=function(){fxcmSimpleAjax.get(e+"/rb-maps/",function(e){if("object"!=typeof e)return!1;t="object"==typeof e.demo_rb_map?e.demo_rb_map:[],n="object"==typeof e.live_rb_map?e.live_rb_map:[],amplify.publish("fxcm.rbs.onLoad")})};return a.getRb=function(e){if("object"!=typeof e||!e.platform)return!1;var t;e.country||("object"==typeof redirectData&&"string"==typeof redirectData.country?e.country=redirectData.country.toLowerCase().replace(/[-_\s.,]+|(?:&[a-z]{3,6};)|&/gi,"_"):e.country="n/a");for(var n=a.getRbMap(e.type),r=-1<c.indexOf(e.country),o=fxcmCountryBuckets.getBucket(e.country),i=0;i<n.length;i++)if(n[i].platform===e.platform)if(n[i].spread_bet){if(r){t=n[i].name;break}}else if("object"!=typeof n[i].country_buckets)t=n[i].name;else if("object"==typeof o&&-1<n[i].country_buckets.indexOf(o.name)){t=n[i].name;break}return t||!1},a.getRbProps=function(e,t){for(var n={},r=a.getRbMap(t),o=0;o<r.length;o++)r[o].name===e&&((n=JSON.parse(JSON.stringify(r[o]))).spreadBet=n.hasOwnProperty("spread_bet")&&!1!==n.spread_bet,delete n.spread_bet);return n},a.getRbMap=function(e){return"live"===e?n.slice():t.slice()},"object"==typeof fxcmCountryBuckets&&fxcmCountryBuckets.getAllBuckets().length?r():amplify.subscribe("fxcm.countryBuckets.onLoad",function(){r()}),a}(),fxcmForms=fxcmForms||{};fxcmForms.checkboxAltValues=function(){var a,e={};return e.apply=function(e){(a=$(e)).find('input[type="checkbox"]').each(function(e,t){var n,r,o=$(t).attr("name"),i=a.find('input[type="hidden"][name="'+o+'"]');i.length&&(n=$(t),r=i,n.on("change",function(){r.prop("disabled",n.is(":checked"))}).trigger("change"))}).trigger("change")},e}(),fxcmForms.demoRbSwapper=function(){var r,e={},o={$form:{},$rbField:{},$currencyField:{}},n=function(){o.$countrySelect=o.$form.find('select[name="demo.country"]'),o.$countrySelect.on("change",function(){var e,t=o.$countrySelect.find("option:selected").attr("value"),n=fxcmRbs.getRb({country:t,type:"demo",platform:r});"string"==typeof(e=n)&&e.length&&o.$rbField.val(e),function(e){var t=fxcmRbs.getRbProps(e,"demo");if(!o.$currencyField.length||!t.db||!t.db.length)return;var r=t.db.join(" | ");o.$currencyField.find("option").each(function(e,t){if("string"!=typeof t.value||!t.value.length)return!0;var n=new RegExp(t.value+"\\s*:\\s*'([a-z0-9-_]+)'","i");$(t).prop("disabled",!n.test(r))}),o.$currencyField.find("option:selected").prop("disabled")&&o.$currencyField.prop("selectedIndex",o.$currencyField.find("option:not(:disabled)").eq(0))}(n),fxcm.internal.setDynamicFormName(o.$form),amplify.publish("fxcm.form.onUpdate.rb",{formId:o.$form.attr("id"),newRb:n})}).trigger("change")};return e.apply=function(e){if(o.$form=$(e),o.$rbField=o.$form.find('input[name="rb"]'),o.$currencyField=o.$form.find('select[name="demo.currency"]'),!o.$form.length||!o.$rbField.length)return!1;amplify.subscribe("fxcm.rbs.onLoad",function(){var e,t;e=o.$rbField.val(),t=fxcmRbs.getRbProps(e,"demo"),r=t.platform?t.platform:"ts",n()})},e}(),fxcmForms.balanceSliders=function(){var e={};return e.apply=function(e){if("undefined"==typeof noUiSlider||!e)return!1;$(e).find('input[name="demo.initial_balance"]').each(function(e,t){var n,r,o=$(t),i=function(e){if(!e.length)return!1;var t=document.createElement("div");return t.className="slider balance-slider",noUiSlider.create(t,{start:e.val(),connect:[!0,!1],step:1e3,range:{min:2e3,max:5e4}}),e.addClass("slider-value").before(t),e.attr({step:1e3}),e.parent().append('<div class="clear"></div>'),t}(o);r=o,(n=i).noUiSlider.on("update",function(e){r.val(e)}),r.on("blur",function(){var e=r.val();e=e<2e3?2e3:5e4<e?5e4:e,r.val(e),n.noUiSlider.set(Number(e))})})},e}(),fxcmForms.phoneFormatter=function(){var e={},o={$form:[],$country:[],$phonesVis:[]},n=function(e){var t=$(e);if(!t.length)return!1;var n,r=i(t.val(),(n=o.$country)&&n.length?n.find("option").eq(n.prop("selectedIndex")).attr("data-tel-prefix"):"");r=/^\+\d+/.test(r)?r:"",o.$form.find('input[type="hidden"][name="'+t.attr("name")+'"]').val(r)},i=function(e,t){if(!/\d/.test(e)||"string"!=typeof t||!t.length)return e;var n=/[^\d]/g;return t=t.replace(n,""),e=(e=e.replace(n,"")).replace(new RegExp("^("+t+")?0?"),"+"+t)};return e.apply=function(e){if(o.$form=$(e),o.$country=o.$form.find('select[name="country"], select[name="demo.country"]'),o.$phonesVis=o.$form.find('input[name*="phone"]').not('[type="hidden"]'),!o.$form.length||!o.$country.length||!o.$phonesVis.length)return!1;o.$phonesVis.each(function(e,t){$(t).on("change",function(){n($(t))})}),o.$country.on("change",function(){o.$phonesVis.each(function(e,t){n($(t))})})},e}();var fxcmAjaxWpContent=function(){var e={},t=!1,i="ajax-loaded",a={scripts:[],stylesheets:[]},n=function(){var e=$("body").attr("class").match(/page-id-([0-9]*)/i);return null!==e&&e.length?e[1]:""},c=function(e,t){if("object"!=typeof e||!e.length)return t(),!1;for(var n,r=!0;r&&e.length;)n=e.shift(),r=!(a.scripts.indexOf(n)<0);if(r)return t(),!1;a.scripts.push(n);var o=document.createElement("script");$("body").append(o),$(o).on("load",function(){e.length?c(e,t):t()}),o.setAttribute("src",n.src)};return e.loadContent=function(e){if(t)return!1;$(e).each(function(e,t){var o=$(t);!function(e,t){if("number"!=typeof e||"function"!=typeof t)return;fxcmSimpleAjax.post(fxcmcom.ajax_url,t,{params:{action:"ajax_load_shared_content",post_id:e,page_id:n()}})}(o.data("post-id"),function(e){var t,n,r=function(e){var t,n,r={scripts:[],stylesheets:[]};for(var o in r)if(e.hasOwnProperty(o)){for(var i=0;i<e[o].length;i++){n="string"==typeof e[o][i].src?e[o][i]:e[o][i].file||"",r[o].push(n),t=e[o][i].hasOwnProperty("dependencies")?e[o][i].dependencies:[];for(var a=0;a<t.length;a++)"string"==typeof t[a].src&&r[o].push(t[a])}r[o].reverse()}return r}(e);t=o,n=e.html,t.length&&"string"==typeof n&&t.html(n),function(e){if("object"!=typeof e||!e.length)return;for(var t=0;t<e.length;t++)a.stylesheets.indexOf(e[t])<0&&($("head").append('<link rel="stylesheet" href="'+e[t].src+'" type="text/css" />'),a.stylesheets.push(e[t].src))}(r.stylesheets),c(r.scripts,function(){o.addClass(i)})})}),t=!0},e}(),fxcmDisclaimers=function(){var e={},a=[],c=!0,t={$addDisclaimers:$(".additional-disclaimers .disclaimer"),$pageDisclaimers:$("#page-disclaimers-main")};t.$disclaimersParent=t.$pageDisclaimers.find(".disclaimers-visible");var n=function(e,t){var n=/^([0-9]+)|(\*+)|(â€ +)|(â€¡+)/,r="string"==typeof e.ref?n.exec(e.ref):null,o="string"==typeof t.ref?n.exec(t.ref):null,i=0;if(!r&&!o)return 0;if(r&&!o)return-1;if(!r&&o)return 1;if(c){if(!e.context&&t.context)return-1;if(e.content&&!t.context)return 1}for(var a=1;a<5;a++)if(r[a]||o[a]){if(r[a]&&!o[a]){i=-1;break}if(o[a]&&!r[a]){i=1;break}if(1===a){if(r[a]<o[a]){i=-1;break}if(r[a]>o[a]){i=1;break}}else{if(r[a].length<o[a].length){i=-1;break}if(r[a].length>o[a].length){i=1;break}}}return i},r=function(e){var t={$el:$(e)},n=/disclaimer-([a-z0-9_-]+)/i.exec(e.getAttribute("class")),r=!!(n&&1<n.length)&&n[1],o=t.$el.closest(".additional-disclaimers"),i=t.$el.closest(".shared-content");(function(e){if(!e||"custom"===e)return!1;for(var t=!1,n=0;n<a.length;n++)if(a[n].alias===e){t=!0,console.log('The disclaimer "'+e+'" is attempting to be shown twice on this page.');break}return t})(r)||(t.ref=t.$el.find("sup.reference-num").text(),t.alias=r,o.length&&o.data("relContentType")&&o.data("relContent")?(t.context={},t.context[o.data("relContentType")]=o.data("relContent")):i.length&&i.data("sharedContentAlias")&&(t.context={},t.context.shared_content=i.data("sharedContentAlias"),t.noMove=!0),a.push(t)),t.noMove||t.$el.remove()};return e.cleanUp=function(){t.$disclaimersParent.find(".disclaimer").each(function(e,t){r(t)}),t.$addDisclaimers.each(function(e,t){r(t)}),$(".shared-content").find(".disclaimer").each(function(e,t){r(t)}),a.sort(n),a=function(e){for(var t=["0"],n=$(),r="disclaimer-updated",o="",i=0;i<e.length;i++)if(e[i].ref&&e[i].ref.length){o=e[i].ref;for(var a=0;a<t.length;a++){if(/[0-9]+/.test(e[i].ref)&&/[0-9]+/.test(t[a])){Number(e[i].ref)<=Number(t[a])&&(e[i].ref=(Number(t[a])+1).toString()),t[a]=e[i].ref;break}if(new RegExp("["+t[a].charAt(0)+"]+","i").test(e[i].ref)){e[i].ref.length<=t[a].length&&(e[i].ref=t[a]+t[a].charAt(0)),t[a]=e[i].ref;break}}t.indexOf(e[i].ref)<0&&t.push(e[i].ref),o!==e[i].ref&&"object"==typeof e[i].context&&(e[i].context.journey?n=$('[data-journey="'+e[i].context.journey+'"]').find(".hero-body"):e[i].context.shared_content&&(n=$(".shared-content."+e[i].context.shared_content)),n.find('sup:contains("'+o+'"):not( .'+r+" )").text(e[i].ref).addClass(r),e[i].$el.find("sup.reference-num").text(e[i].ref))}return $("."+r).removeClass(r),e}(a),c=!1,a.sort(n);for(var e=0;e<a.length;e++)a[e].noMove||a[e].$el.appendTo(t.$disclaimersParent);t.$disclaimersParent.find(".disclaimer").length&&t.$pageDisclaimers.removeClass("hidden")},e}(),fxcmTsDemo=function(){var o,t,r={},i=!1,a="about:blank",c="https://tradingstation.fxcm.com",s=!1,f="n/a",l={"demo.lastname":"Generic1234","demo.email_address":"tsdemo@fxcm.com"},e=function(){fxcmSimpleAjax.get("//static.fxcm.co.uk/status/fxdr.php",function(e){!0===e&&(i=!0)},{responseType:"jsonp"})},n=function(){var e=fxcmcom.api_endpoint+"/generic-demo-settings/";fxcmSimpleAjax.get(e,function(e){if("object"!=typeof e)return!1;var t,n,r=fxcmRbs.getRb({platform:"ts",type:"demo"}),o=fxcmRbs.getRbProps(r);if(l.rb=r,f=e.currency||f,o.db&&o.db.length){t=1<o.db.length&&"string"==typeof e.currency?new RegExp(e.currency+"\\s*:\\s*'([a-z0-9-_]+)'","i"):new RegExp("[a-z]+\\s*:\\s*'([a-z0-9-_]+)'","i");for(var i=0;i<o.db.length;i++)if(null!==(n=t.exec(o.db[i]))&&n[1]){l.DB=n[1];break}}s=o.spreadBet,a="string"==typeof e.tsweb_splash_page?e.tsweb_splash_page:a,"string"!=typeof e.locale||/^en/.test(e.locale)||(c+="?lc="+e.locale.replace(/-/g,"_"))})},u=function(){var e,n={rb:l.rb,db:l.DB,isSb:s,currency:f,success:!1};(e=function(e){var t=c;"object"==typeof e&&"string"==typeof e.webtsurl&&e.webtsurl.length&&(t=r.validateTsWebUrl(e.webtsurl),n.success=!0),r.updateTsWebWindow(t),amplify.publish("fxcm.form.onGenericDemoRequest",n)},!!(i&&l.rb&&l.DB)&&(fxcmSimpleAjax.get("https://secure4.fxcorporate.com/tr-demo/form/service/?format=jsonp",e,{params:l,responseType:"jsonp"}),!0))||(r.updateTsWebWindow(c),amplify.publish("fxcm.form.onGenericDemoRequest",n))},p=function(e){if(clearTimeout(t),e)return!1;t=setTimeout(function(){r.updateTsWebWindow(c)},15e3)};return r.validateTsWebUrl=function(e){return"string"!=typeof e||(e=(e=(e=e.replace("tsweb.fxcorporate.com","tradingstation.fxcm.com")).replace("/drlanding.jsp","")).replace("token=","token_id="),e+=/conn=demo/.test(e)?"":"&conn=demo",e+=s?"&sb=true":"","function"==typeof gtmGenerateDecoratedUrl&&(e=gtmGenerateDecoratedUrl(e))),e},r.launchTsWebWindow=function(e){e="string"==typeof e&&e.length?e:a;var t=[],n={scrolling:"yes",toolbar:"no",menubar:"no",resizable:"yes",height:.85*screen.availHeight,width:.85*screen.availWidth,personalbar:"no",status:"no"};for(var r in n.top=(screen.availHeight-n.height)/2,n.left=(screen.availWidth-n.width)/2,n)t.push(r+"="+n[r]);return p(),o=window.open(e,"windowChromelessTs",t.join(", "))},r.updateTsWebWindow=function(e){if("string"!=typeof e||!o)return!1;p(!0),o.location=e;try{o.focus()}catch(e){}},r.genericDemoLink=function(e){var t=$(e);if("mobile"===fxcm.device.getBreakpoint()||!t.length)return!1;t.on("click",function(e){e.preventDefault(),r.launchTsWebWindow(),c=t.attr("href"),u()})},e(),amplify.subscribe("fxcm.rbs.onLoad",function(){n()}),r}(),fxcmPersistentDisclaimer=function(){var e={},t={$disclaimerPersist:$("#persistent-disclaimer"),$disclaimerDefault:$("#default-disclaimer"),$spacer:$("#persistent-spacer")},n="open",r={"/uk/":[/.*/],"/fr/":[/.*/],"/de/":[/.*/],"/it/":[/.*/],"/es/":[/spain/]},o=function(){$(window).on("resize load",function(){var e;e=t.$disclaimerPersist.height(),t.$spacer.css({height:e+"px"})})};return e.init=function(){o(),function(){var e="object"==typeof redirectData&&"string"==typeof redirectData.country&&redirectData.country.length?redirectData.country:"";for(var t in e=e.trim().toLowerCase().replace(/[ -&.~()]+/g,"_"),r)if(new RegExp(t).test(fxcmcom.base_path))for(var n=0;n<r[t].length;n++)if(r[t][n].test(e))return!0}()&&t.$disclaimerPersist.addClass(n)},e}(),fxcmGetAssets=function(e,r){if(!$||!fxcmcom)return"Sorry, an error occured";var o,t=[],i=fxcmcom.base_url.replace(fxcmcom.base_path,""),a=function(e){if("string"!=typeof e)return!1;var t="";return"/"===(e="//"===e.substr(0,2)?document.location.protocol+e:e).charAt(0)?t=i+e:0===e.indexOf(i)&&(t=e),!!t.length&&t},n=function(){var r=[];return $("script").each(function(e,t){var n=a(t.getAttribute("src"));n&&r.push(n)}),r},c=function(){var r=[];return $('link[rel="stylesheet"]').each(function(e,t){var n=a(t.getAttribute("href"));n&&r.push(n)}),r},s=function(){var r=[];return $("img").each(function(e,t){var n=a(t.getAttribute("src"));n&&r.push(n)}),r};r="boolean"==typeof e?e:!!r,e="string"==typeof e?[e]:["js","css","img"];for(var f=0;f<e.length;f++)switch(e[f]){case"script":case"scripts":case"js":t=t.concat(n());break;case"style":case"styles":case"css":t=t.concat(c());break;case"image":case"images":case"img":t=t.concat(s())}!function(e){if(!e||!e.length)return console.log("No entries found");var t=e.length;if(!r)for(var n=0;n<e.length;n++)e[n]=e[n].substr(i.length);o=e.join("\n"),console.log(t.toString()+" entries found"),console.log(o)}(t)},fxpAjaxLoadMore=function(){var e={},n=!1,r={$almWrapper:$("#ajax-load-more")};return e.init=function(){var t=new fxcm.ui.SmoothScroll({trigger:$(this),target:r.$almWrapper,animateSpeed:400,updateHash:!1,offset:-40});$.fn.almComplete=function(e){n&&t.scrollNow(),n=!0}},e}();jQuery(document).ready(function(n){amplify.subscribe("windowLoaded",function(){fxcmAjaxWpContent.loadContent(".load-via-ajax")});var e=setTimeout(function(){fxcmAjaxWpContent.loadContent(".load-via-ajax")},2e3);n(window).on("load",function(){clearTimeout(e),amplify.publish("windowLoaded")}),fxcmDisclaimers.cleanUp(),fxcmPersistentDisclaimer.init(),fxpAjaxLoadMore.init(),n("form").each(function(e,t){fxcmForms.checkboxAltValues.apply(t),fxcmForms.demoRbSwapper.apply(t),fxcmForms.balanceSliders.apply(t),fxcmForms.phoneFormatter.apply(t)}),n('a[href^="https://tradingstation.fxcm.com/FreeDemo"]').each(function(e,t){fxcmTsDemo.genericDemoLink(t)}),amplify.subscribe("fxcm.overlay.onOpen.form",function(){n(lightcase.get("content")).find("form").each(function(e,t){fxcmForms.checkboxAltValues.apply(t),fxcmForms.balanceSliders.apply(t),fxcmForms.phoneFormatter.apply(t)})}),"function"==typeof Glide&&n(".glide").each(function(e,t){new Glide("#"+t.id,{type:"slider",gap:0,autoplay:t.dataset.autoplay||!1}).mount()}),n("a[data-rel^=lightcase]").lightcase({width:9999,maxWidth:1280,maxHeight:1e3,shrinkFactor:1,fullScreenModeForMobile:!1,onFinish:{renderVideo:function(){amplify.publish("fxcm.overlay.onOpen");var e=n("#lightcase-content");if(e.find(".limelight")[0]){n("html").attr("data-lc-type","video");var t=e.find(".limelight");fxcm.limelight.renderLimelightVideo(t),lightcase.resize()}e.find("form")[0]&&(n("html").attr("data-lc-type","form"),amplify.publish("fxcm.overlay.onOpen.form"),lightcase.resize())},moveClose:function(){n(".lightcase-icon-close").appendTo(n("#lightcase-content"))}},iframe:{width:"100%",height:function(){return n(window).outerHeight()}},ajax:{width:1140},inline:{width:1140}}),n("#country-select").on("change",function(){var e=n(this).val().toString();"function"==typeof gtmGenerateDecoratedUrl&&(e=gtmGenerateDecoratedUrl(e)),window.location=e})});
//# sourceMappingURL=site.min.js.map